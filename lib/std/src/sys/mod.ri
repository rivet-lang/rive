// Copyright (C) 2022 The Rivet Team. All rights reserved.
// Use of this source code is governed by an MIT license
// that can be found in the LICENSE file.

<<<<<<< HEAD:lib/std/src/sys/mod.ri
import "libc";

import "../process";
=======
use pkg::stdc;
use pkg::process::panic;
>>>>>>> fd5cbb707991f17d1cc05e277c0ef9c401dd652c:lib/core/src/sys/mod.ri

/// Returns the number of virtual CPU cores found on the system.
pub fn nr_cpus() i32 {
#if _LINUX_
<<<<<<< HEAD:lib/std/src/sys/mod.ri
    return unsafe { libc.get_nprocs() };
#else
    process.panic("`nr_cpus` only works on linux (for now)");
=======
    return unsafe { stdc::get_nprocs() };
#else
    panic("`nr_cpus` only works on linux (for now)");
>>>>>>> fd5cbb707991f17d1cc05e277c0ef9c401dd652c:lib/core/src/sys/mod.ri
#endif
}

/// Returns true if the current executable is running on a 32-bit system.
pub fn is_32bit() bool {
    return size_of!(*void) == 4;
}

/// Returns true if the current executable is running on a 64-bit system.
pub fn is_64bit() bool {
    return size_of!(*void) == 8;
}

/// Returns true if the current executable is running on a little-endian system.
pub fn is_little_endian() bool {
    return unsafe { as(i32, as(*i8, addr_of!(1)).*) } == 1;
}

/// Returns true if the current executable is running on a big-endian system.
pub fn is_big_endian() bool {
    return unsafe { as(i32, as(*i8, addr_of!(1)).*) } == 0;
}
